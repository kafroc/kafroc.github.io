---
layout: post
comments: true
title: OWASP安全测试指南v4.0 解读
category: 网络安全
keywords: Testing Guide,OWASP,2020
---

# OWASP 测试项目 简介

> OWASP 测试项目已经发展了许多年。通过这个项目，我们希望帮助人们了解自己的 Web 应用程序，什么是测试，为什么要测试，什么时间，在哪里 以及 如何测试 WEB 应用程序。这个项目是发布一个完整的测试框架，而不是仅仅提供一个简单的漏洞检查列表或者问题的简单药方。人们可以根据需要建立自己的或符合其它进程的测试程序。测试指南详细的介绍了一般测试框架以及实践中该框架的实施技术。<br><br>创作这份测试指南是一项艰巨的任务。要获取大家的一致认可同时发展内容是一个极具挑战的任务。这不仅需要使人们接受这里所描述的概念，同时使他们能够真正将这些概念应用于自己的环境和文化中。同时，这也是对将目前 Web 应用测试重点，将渗透测试转变为测试集成于软件开发生命周期过程中的挑战。<br><br>然而，我们已经达到非常满意的结果。许多业内专家和世界上一些大型公司的软件安全负责人共同验证了这个测试框架。这个测试框架帮助各类组织能够有效针对 Web 应用程序进行测试以便建立安全可靠软件，而不是简单地强调脆弱点。虽然后者无疑是许多 OWASP 指南和清单的一个副产品。因此，对于某些测试方法和技术，我们作出了艰难的选择，因为我们都明白并这些方法和技术并不是适用于每一个人。然而，随着时间的推移，OWASP 能够在丰富的经验和协商一致的基础上通过宣传和教育达到更高的层次并进行文化变革。[2]

# OWASP 安全测试指南 v4.0 简介

首先我要说的是学习没有捷径，21 天是学不到别人吃饭的家伙的。

## 这本书讲了什么

这本书**结构化**的介绍了该如何执行 Web 的渗透测试，这本书的特点是非常的系统，介绍了 Web 渗透测试的方法论，虽然在漏洞的描述和展示上也很丰富，但毕竟无法针对单个漏洞进行生动形象的呈现。

如果你去面试渗透岗位，或者领导让你去执行某个域名，或者站点的渗透测试，那么这么书可以很好的指导你。你按照这本书的方法一步一步执行，就可以很好的完成 Web 渗透测试。

总而言之，这是一本教你怎么做 Web 渗透测试的方法论的书。

## 谁适合读这本书

### 零基础

如果你是零基础，那我不推荐你精读本书，因为如前面说的，虽然内容中对漏洞有解释和描述，但毕竟篇幅有限，无法以生动，更易理解的方式说明漏洞。所以这种情况，你看这本书会很晕，好像每个字都看得懂，但是看完又不知道在说什么。

但是你可以粗读本书，了解有哪些漏洞类型，有不懂的，或者感兴趣的漏洞，再去找其他文章看看，理解了以后再回来精读本书。

### 有基础，但不系统

那这本书是非常适合你的，很多人可能很不屑，觉得自己经验丰富，SQL 注入信手拈来，但是有个毛病就是容易漏测，同样一个系统这次漏洞 1，2，3， 下次漏洞 2，3，4 好像每次测试都有新漏洞发现，如果你说不清楚原因，客户肯定不会满意的。

为什么会出现漏测的现象呢？很简单，要么就是定义的测试范围不一样，导致每次发现的漏洞是不一样的。要么是不知道该怎么系统性，结构化的测试，完全凭借头脑的灵感。这两种漏测是完全不一样的，甚至可以说第一种并不是漏测，而是很自然的现象。第二种就是典型的漏测，而且很危险。换句话说，第二种情况你提交给甲方的报告是零漏洞，甲方应该怎么想，是我的产品真的非常安全吗？还是你这个渗透测试人员不靠谱？

借用大佬 Gary McGraw 的一句话来说

> “If you fail a penetration test you know you have a very bad problem indeed. If you pass a penetration test you do not know that you don’t have a very bad problem”.

本书的重点就是这一类的人

### 有基础，成系统

如果你已经在这个阶段，至少已经是高级渗透测试人员了，那么本书说不定可以给你一个好的参考，对比你已有的体系和该书介绍的体系有何差异，取长补短。

## 应该怎么读这本书

书很厚，一头就扎进去读好像不是很符合这个快节奏的社会，所以我写这篇文章更像是一篇导读，在一头扎进去之前，看看我这篇文章也许能更有效的吸收书里的知识。但是导读归导读，书还是要慢慢看的。

在接下来的章节，我将以总分的结构来讲述本书内容。

# OWASP 安全测试指南 v4.0 总章

从老板给你一个测试任务到你交付测试报告，这个过程你应该怎么做。我们来看一下测试指南教我们怎么做
![otg-diagram](http://kafroc.github.io/assets/img/otg-diagram.jpg)
我们看上图，详细罗列来从开始到结束的流程。我先不对每个过程做介绍，我倒更想说说为什么要这么排列，这还是蛮有趣的。

首先接到任务，可能有各种情况，有可能是黑盒测试，可能是灰盒测试，也可能是白盒测试，假设是资源最少的黑盒测试，给你一个域名，或者几个 ip，你应该怎么测呢？

第一步：信息搜集<br>
通过 OSINT 搜集信息，搜集子域名，搜集应用程序入口，识别 web 服务器，识别应用程序框架，总之就是搜集尽可能多的信息。信息搜集看似简单，实际上是非常关键。

在搜集后，开始真正进行测试

第二步：配置以及部署管理测试<br>
我们知道整个 web 环境涉及到 操作系统，web 服务器，web 容器，开发框架，编程语言等
这管理员配置这些环境时，就有很多测试点，比如是否使用存在漏洞的 struts2，操作系统是否没打补丁，先把配置/环境的问题测试了，再进行 web 应用的测试

接下来你面临的是不是登陆的问题，有些产品不登陆就一个 login 页面，能力再强也无能为力。说到登陆，就一定要提到登陆三件套，身份，认证，授权
我记得我准备 Security+的时候，就有一题模拟题是这样的

> Which of the following is the proper order for logging a user into a system from the first step to the last step?<br>
> A. Identification,authentication,authorization

Identification,authentication,authorization 也就是身份，认证，授权

我们以人类社会来比喻，身份就是个人姓名，或者是公司工号，认证就是检验你是不是你

题外话，认证方式有多种

- something you know (你知道什么，比如密码，PIN 码)
- something you have （你有什么，比如工卡，智能卡，钥匙）
- something you are （你是什么，比如指纹，虹膜）
- something you do （你做什么，比如签名，步态）

授权方式也有多种

- DAC （自主访问控制）
- MAC （强制访问控制）
- RBAC （基于角色的访问控制）
- ABAC （基于属性的访问控制）

所以，接下来分别是<br>
第三步 身份鉴别管理测试<br>
第四步 认证测试<br>
第五步 授权测试

认证完了以后，授权应该是以会话为中心的，所以

第六步 会话管理测试<br>
主要测试 CSRF，会话固定，会话退出，会话超时等等会话相关的项目

第七步 输入验证测试<br>
登陆进去了，能输入的点就多了起来，真的输入验证的测试也就更多，此时做输入验证测试正合适

第八步 错误处理测试<br>
输入异常是不是就会出错，正好在这时做错误处理测试，一般来说报错时不能泄露敏感信息，告知客户异常即可，提示应该模糊化。

接下来，密码学测试，业务逻辑测试，客户端测试 相对来说较独立，可以独立测试。

以上就是我对本书总体结构的认识，我前文一直强调的 系统性，结构化，上面的分类和测试逻辑就是我强调的。这是经过专家认可的

> 许多业内专家和世界上一些大型公司的软件安全负责人共同验证了这个测试框架。这个测试框架帮助各类组织能够有效针对 Web 应用程序进行测试以便建立安全可靠软件，而不是简单地强调脆弱点。

下面我们将分章节讲解每一个测试项的细节

# 参考文献

[1][owasp web security testing guid官网](https://owasp.org/www-project-web-security-testing-guide/)<br>
[2][安全测试指南(第4版)](https://kennel209.gitbooks.io/owasp-testing-guide-v4/content/zh/introduction/index.html)
